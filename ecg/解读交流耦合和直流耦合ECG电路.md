> 来源于ADI的一篇文档[^1]，关于交流耦合和直流耦合电路的介绍



心电信号的采集电路，从信号链的架构上可以分为两类：交流耦合、直流耦合。

## 交流耦合

交流耦合电路使用分立器件，使用电容的隔直功能将心电信号提取出来。基本架构如下图所示。

![](http://www.mythbird.com:8000/f/2967de614966406f95cd/?dl=1)

信号通过抗除颤、抗静电保护，经过低通滤除高频干扰，进入全差分放大电路低倍放大后，使用高通滤除低频干扰，然后经过高倍放大，最后进入低精度ADC转换为数字信号。

由于使用了电容的交流耦合功能，对于低频的肌电干扰、工频干扰和基线漂移抑制作用较低。因为高通的截止频率设置的为心电的最低频率0.1Hz左右，对于50Hz/60Hz、1Hz这种信号无法滤除，电路本身的缺点导致信号的质量不佳。

上面的架构，为了提高信号质量，也要做屏蔽驱动、右腿驱动电路，甚至需要做WCT（威尔逊中心点）。

使用TI-TINA对该架构进行仿真，如下图所示。

![](http://www.mythbird.com:8000/f/819f0181bcf6413288b7/?dl=1)

将皮肤阻抗，线缆分布电容、电阻都考虑在内，使用屏蔽驱动和右腿驱动，通过差分放大（此时输出的信号为直流耦合信号），经过大电容耦合（此时为交流耦合信号），最终经过高倍放大输出信号。

差分放大11倍，后级放大80倍，总共880倍。

使用真实信号进行仿真，结果如下图所示。

<img src="http://www.mythbird.com:8000/f/7fd52846e4404c53932d/?dl=1" style="zoom:80%;" />

VG1为共模工频干扰，经过屏蔽驱动和右腿驱动后输出反相信号VF2，正好与VG1抵消。从结果上看工频干扰已被滤除，心电信号经过前级匹配电路时有衰减，但是经过后级放大，信号范围为：2~4V，已达到常规ADC的识别范围。

再来分析下CMRR，将差分的正相、反相输出短路，使用VG1作为共模输入信号，仿真VF1的频率特性，对右腿电路中的RG进行扫描仿真（设置值范围为100K~10M）。如下图所示。

<img src="http://www.mythbird.com:8000/f/a80bfd6b8c2449c39568/?dl=1" style="zoom:80%;" />

可见，对于1kHz以下的信号，CMRR<-100dB，抑制能力很高。

下面对稳定性进行仿真（将屏蔽驱动去掉），如下图所示。

![](http://www.mythbird.com:8000/f/2497b4c494ac4179b2b4/?dl=1)

可见，使用初始条件（1mV）进行仿真会出现震荡，说明右腿不稳定。

给右腿加上相位补偿后，如下图所示。

![](http://www.mythbird.com:8000/f/f48db25a88de425fa5c2/?dl=1)

通过稳定性分析，如下图所示（这里使用[^4]的仿真方式，与TI教程中所述不同，后续会对稳定性分析进行说明）。

![](http://www.mythbird.com:8000/f/2d5b2b9c1ac74eb69f73/?dl=1)

Aol与1/β的幅频曲线滚降差值小于40dB/Decade，系统为稳定状态。至于相位补偿的值可以参考[^2]来设定。

对于消费类电子，上面的优化可以省略，右腿驱动直接接地，然后对地取各肢体导联的信号，最终通过加减法算出通道的值。

![](http://www.mythbird.com:8000/f/3721d5fcee8641819c10/?dl=1)

在ADI的文档中如下图所示。

<img src="http://www.mythbird.com:8000/f/954d695108f344dfbde8/?dl=1" style="zoom:80%;" />

该消费类对于干扰抑制较低，只有在平静且空旷的环境或者家居环境下才能达到较好的效果。

交流耦合电路需要将心电信号放大到MCU内部ADC的识别要求，一般需要放到800~1000倍甚至更高，以达到ADC采样要求。当然放大倍数越高导致噪声放大越高，共模抑制比相应降低，而低精度的ADC转换后的信号质量也会降低。

## 直流耦合

直流耦合电路相对来说简单许多，其通过保护电路后，直接经过低通滤波，然后进入集成芯片中。

<img src="http://www.mythbird.com:8000/f/079fcbcf2d1f4a668773/?dl=1" style="zoom:67%;" />

当然，集成芯片内部的电路架构跟交流的相似，都是内部差分放大、内部WCT和RLD。但是直流耦合不适用高通滤波器来拾取心电信号，而是直接获取整个带直流的信号，经过算法处理来达到基线纠偏、高频滤波等功能。

直流耦合内部使用ΣΔ ADC，可以达到很高位数（高精度），可以获取到uV甚至nV级别的信号。而心电信号本身只有mV，高精度的ADC采样能获取准确的心电信号。多余的工作交给算法来处理，可以极大的降低硬件成本，而效果还可以得到提高。

直流耦合和交流耦合比较如下表所示。

![](http://www.mythbird.com:8000/f/490ec5f16e6943ccbec9/?dl=1)



目前，大部分心电电路使用直流耦合架构，然后使用专业的算法来处理数据。



以上仿真文件，见[^3]

[^1]: [心电图(ECG)解决方案](http://www.mythbird.com:8000/f/85bf41d86b2b4ac59276/?dl=1)

[^2]: [TI 高精度实验室](http://www.ti.com.cn/ww/seminars/PLAB/Operational-Amplifiers.html)
[^3]: [仿真文件](http://www.mythbird.com:8000/f/49b53a736cf540518385/?dl=1)
[^4]: [Signal chain basics Analyzing RL drive in ECG front end with SPICE](http://www.mythbird.com:8000/f/e8467125345f4caca930/?dl=1)

